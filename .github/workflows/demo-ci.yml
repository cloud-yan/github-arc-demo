name: demo-ci
on: [push]

jobs:
  deploy-magic:
    runs-on: gh-runners-arc-scale-set  # My private k8s cluster
    container:
      image: alpine:latest
    steps:
    - name: Cluster Illusion
      run: |
        echo "ðŸ”® Kubernetes Magic Show Starting..."
        echo "âœ¨ Pod Name: $(hostname)"
        echo "ðŸ“¦ Container Info:"
        cat /etc/os-release | grep PRETTY_NAME || echo "No OS info available"
        
        echo "ðŸ’« Creating magic without external tools..."
        echo "ðŸ‡ Pretending to create a deployment..."
        echo 'apiVersion: apps/v1
kind: Deployment
metadata:
  name: k8s-rabbit
spec:
  replicas: 1
  selector:
    matchLabels:
      app: rabbit
  template:
    metadata:
      labels:
        app: rabbit
    spec:
      containers:
      - name: rabbit
        image: alpine
        command: ["sleep", "infinity"]' > rabbit.yaml

        echo "ðŸŽ© Would apply this manifest if kubectl was installed:"
        cat rabbit.yaml
        echo "âœ… Magic complete!"
        
        echo "ðŸŽ© Now watch it disappear..."
        ./kubectl delete deployment k8s-rabbit
        echo "âœ… Magic complete!"
